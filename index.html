<!DOCTYPE html>
<html lang="en"> <!-- Changed language to English -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸŽ¬ Exclusive Movie Preview | Limited Time Offer</title> <!-- English Title -->

    <!-- =============================================================== -->
    <!-- Open Graph Meta Tags (For Facebook, Instagram, WhatsApp) -->
    <!-- =============================================================== -->

    <!-- REQUIRED: Provide the actual title of the post -->
    <meta property="og:title" content="ðŸŽ¬ Exclusive Movie Preview | Watch Now!">

    <!-- REQUIRED: Provide an attractive short description of the post -->
    <meta property="og:description" content="Watch this exclusive preview before it's gone! Click now for a special viewing experience.">

    <!-- REQUIRED: Provide the link to your preview image or GIF here (This link will show in the share) -->
    <!-- New GIF link added -->
    <meta property="og:image" content="https://archive.org/download/et00441505-tzgtwlxesf-landscape/et00441505-tzgtwlxesf-landscape.jpg"> <!-- *** This GIF will show in the preview *** -->
    <!-- Optional: If GIF dimensions are known, you can add them, but it's not essential -->
    <!-- <meta property="og:image:width" content="480"> -->
    <!-- <meta property="og:image:height" content="270"> -->

    <!-- REQUIRED: Provide the actual link to your Blogger post here -->
    <meta property="og:url" content="https://archive.org/download/et00441505-tzgtwlxesf-landscape/et00441505-tzgtwlxesf-landscape.jpg"> <!-- *** CHANGE THIS to your actual blog post link *** -->

    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Movie Mania"> <!-- You can change this site name if needed -->
    <meta property="og:locale" content="en_US"> <!-- Changed locale to English (US) -->

    <!-- Optional: Facebook App ID -->
    <!-- <meta property="fb:app_id" content="YOUR_FACEBOOK_APP_ID"> -->

    <!-- =============================================================== -->
    <!-- Twitter Card Meta Tags (For sharing on Twitter) -->
    <!-- =============================================================== -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ðŸŽ¬ Exclusive Movie Preview | Watch Now!">
    <meta name="twitter:description" content="Watch this exclusive preview before it's gone! Click now for a special viewing experience.">
    <!-- New GIF link added -->
    <meta name="twitter:image" content="https://archive.org/download/et00441505-tzgtwlxesf-landscape/et00441505-tzgtwlxesf-landscape.jpg"> <!-- *** This GIF for Twitter preview too *** -->
    <!-- Optional: Your Twitter handle -->
    <!-- <meta name="twitter:site" content="@YourTwitterHandle"> -->


    <style>
        body {
            background-color: #111;
            text-align: center;
            color: #f0f0f0;
            font-family: 'Arial', sans-serif;
            padding-top: 25px;
            margin: 0;
            line-height: 1.7;
            overflow: hidden; /* Prevents scrollbars during loading/redirect */
        }
        .container {
            max-width: 95%;
            width: 550px;
            margin: 0 auto;
            padding: 15px;
        }
        .gif-container {
            cursor: pointer;
            display: inline-block;
            border: 4px solid #E1306C;
            border-radius: 10px;
            overflow: hidden;
            transition: transform 0.2s ease-in-out;
            box-shadow: 0 5px 15px rgba(225, 48, 108, 0.4);
            margin: 10px 0;
            background: linear-gradient(45deg, #405DE6, #5851DB, #833AB4, #C13584, #E1306C, #FD1D1D, #F56040, #F77737, #FCAF45, #FFDC80);
            padding: 4px;
        }
        .gif-container img {
             display: block;
             width: 100%;
             height: auto;
             border-radius: 6px;
        }
        .gif-container:hover {
            transform: scale(1.03);
        }
        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0 auto;
        }
        h2 {
            margin: 15px 0 10px;
            font-size: 20px;
            color: #ffffff;
            font-weight: bold;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
        }
        p {
            margin: 10px 0;
            font-size: 15px;
            color: #ccc;
        }
        a {
            color: #FCAF45;
            text-decoration: none;
            font-weight: bold;
        }
        a:hover {
            text-decoration: underline;
            color: #F77737;
        }
        .disclaimer {
            font-size: 11px;
            color: #777;
            margin-top: 25px;
            padding-top: 10px;
            border-top: 1px solid #444;
            line-height: 1.4;
        }
        #loadingOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.95);
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            color: white;
            opacity: 0;
            transition: opacity 0.2s ease-in-out; /* Keep transition for smooth appearance */
            visibility: hidden;
        }
        #loadingOverlay.show {
            opacity: 1;
            visibility: visible;
        }
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #444;
            border-top: 5px solid #E1306C;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-top: 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>

    <div id="loadingOverlay">
        <h2>Loading... Please wait</h2> <!-- English Loading Text -->
        <div class="spinner"></div>
    </div>

    <div class="container">
        <h2>Your exclusive preview is loading... â³</h2> <!-- English Heading -->
        <div class="gif-container" id="redirectTrigger">
             <!-- New GIF link here -->
             <img src="https://archive.org/download/et00441505-tzgtwlxesf-landscape/et00441505-tzgtwlxesf-landscape.jpg" alt="Click to watch the exclusive preview"> <!-- English Alt Text -->
        </div>
        <p>If the preview doesn't start automatically, <a id="manualLink" href="#">click here to watch now</a>.</p> <!-- English Text & Link Text -->

        <div class="disclaimer">
            This is an independent preview page. The content displayed is for promotional purposes only. By accessing this page, you agree to our terms of service. This is not an official streaming service. <!-- English Disclaimer -->
        </div>
    </div>

    <script>
        // 1. === IMPORTANT: SET YOUR ACTUAL REDIRECT LINK HERE ===
        const directLink = "https://hindimovie.netlify.app/movie/single-movie-2025"; // Keep your direct link

        // 2. Get loading overlay and redirect trigger elements
        const loadingOverlay = document.getElementById('loadingOverlay');
        const redirectTrigger = document.getElementById('redirectTrigger');
        const manualLink = document.getElementById('manualLink');

        // Set the href for the manual link (as a backup)
        manualLink.href = directLink;

        // 3. Function to perform the redirect
        function performRedirect() {
            if (!loadingOverlay.classList.contains('show')) {
                 loadingOverlay.classList.add('show');
            }
            // Attempt redirect immediately after showing overlay
            try {
                 // Use replace to avoid adding this page to history
                 window.location.replace(directLink);
            } catch (e) {
                console.error("Redirect using replace failed, falling back to href:", e);
                // Fallback if replace fails for any reason
                window.location.href = directLink;
            }
        }

        // 4. Automatic redirect attempt (scheduled for the next event loop tick)
        const autoRedirectTimeout = setTimeout(performRedirect, 0); // Start redirect ASAP

        // 5. Click event listeners (for GIF and manual link)
        function handleUserClick(event) {
            event.preventDefault(); // Prevent default link behavior
            clearTimeout(autoRedirectTimeout); // Stop the automatic redirect if it hasn't fired
            console.log('Redirect triggered by user click.');
            performRedirect(); // Perform redirect immediately on click
        }

        redirectTrigger.addEventListener('click', handleUserClick);
        manualLink.addEventListener('click', handleUserClick);

        // 6. Fail-safe redirect (if nothing happens after 5 seconds)
        // This handles cases where the initial script might fail or be blocked
        setTimeout(() => {
            // Check if the overlay hasn't been shown yet (meaning redirect likely didn't start)
            if (!loadingOverlay.classList.contains('show')) {
                 console.warn("Initial redirect might have failed. Forcing redirect now.");
                 performRedirect();
            }
        }, 5000); // 5 seconds

    </script>
</body>
</html>                ${movie.link3 ? `<a href="${movie.link3}" target="_blank" class="download-btn">360p</a>` : ''}
                <button class="share-button" onclick="sharePost('${key}')">Share</button>
            </div>
        `;
        
        viewerModal.style.display = 'block';
        incrementViewCount(key);
    }

    function closeModal(modalId) {
        document.getElementById(modalId).style.display = 'none';
    }

    window.onclick = function(event) {
        if (event.target == viewerModal) {
            viewerModal.style.display = "none";
        }
        if (event.target == savedPostsModal) {
            savedPostsModal.style.display = "none";
        }
    }

    // --- Share Functionality ---
    function sharePost(key) {
        const movie = allMoviesData[key];
        if (navigator.share) {
            navigator.share({
                title: movie.title,
                text: `Check out ${movie.title}! You can watch or download it here.`,
                url: window.location.href, // You can make this URL more specific if you implement routing
            })
            .then(() => console.log('Successful share'))
            .catch((error) => console.log('Error sharing', error));
        } else {
            alert('Share feature is not supported in your browser.');
        }
    }
    
    // --- Save Post Functionality ---
    function toggleOptionsMenu(event, key) {
        event.stopPropagation();
        const menu = document.getElementById(`menu-${key}`);
        menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
    }

    document.addEventListener('click', () => {
        document.querySelectorAll('.options-menu').forEach(menu => menu.style.display = 'none');
    });

    function savePost(event, key) {
        event.stopPropagation();
        let saved = JSON.parse(localStorage.getItem('savedPosts')) || [];
        if (!saved.includes(key)) {
            saved.push(key);
            localStorage.setItem('savedPosts', JSON.stringify(saved));
            alert('Post saved!');
        } else {
            alert('This post is already saved.');
        }
        document.getElementById(`menu-${key}`).style.display = 'none';
    }

    savedPostsButton.onclick = function() {
        savedPostsContainer.innerHTML = '';
        const savedKeys = JSON.parse(localStorage.getItem('savedPosts')) || [];
        if (savedKeys.length === 0) {
            savedPostsContainer.innerHTML = '<p>No saved posts yet.</p>';
        } else {
            savedKeys.forEach(key => {
                const movie = allMoviesData[key];
                if (movie) {
                    const postElement = document.createElement('div');
                    postElement.innerHTML = `<p><a href="#" onclick="openViewer('${key}'); closeModal('savedPostsModal');">${movie.title}</a></p>`;
                    savedPostsContainer.appendChild(postElement);
                }
            });
        }
        savedPostsModal.style.display = 'block';
    };

    // --- Other Functionalities ---
    function incrementViewCount(key) {
        const movieRef = database.ref(`movies/${key}/viewCount`);
        movieRef.transaction(currentCount => (currentCount || 0) + 1);
    }
    
    function toggleLike(key) {
        const storageKey = `liked_${key}`;
        if (localStorage.getItem(storageKey)) {
            alert("You've already liked this movie.");
            return;
        }
        const likeRef = database.ref(`movies/${key}/likeCount`);
        likeRef.transaction(currentLikes => (currentLikes || 0) + 1).then(() => {
            localStorage.setItem(storageKey, 'true');
        });
    }
    
    function filterByCategory(category) {
        currentCategoryFilter = category.toLowerCase();
        document.querySelectorAll('.category-filters button').forEach(btn => {
            btn.classList.toggle('active', btn.textContent.toLowerCase() === currentCategoryFilter);
        });
        filterMovies();
    }

    function filterMovies() {
        const query = document.getElementById('search-bar').value.toLowerCase();
        document.querySelectorAll('.movie-card').forEach(card => {
            const key = card.getAttribute('data-key');
            const movie = allMoviesData[key];
            if (movie) {
                const title = movie.title.toLowerCase();
                const category = (movie.category || '').toLowerCase();
                const isCategoryMatch = currentCategoryFilter === 'all' || category === currentCategoryFilter;
                const isSearchMatch = title.includes(query);
                
                card.style.display = isCategoryMatch && isSearchMatch ? 'block' : 'none';
            }
        });
    }

</script>
</body>
</html>
